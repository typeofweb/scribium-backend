generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int         @id @default(autoincrement())
  email         String      @unique
  password      String      @unique
  roles         Role[]
  userDetails   UserDetails @relation(fields: [userDetailsId], references: [id])
  userDetailsId Int         @unique @map("user_details_id")
  teacher       Teacher?
  student       Student?

  @@map("user")
}

model UserDetails {
  id        Int    @id @default(autoincrement())
  firstName String @map("first_name")
  lastName  String @map("last_name")
  address   String
  user      User?

  @@map("user_details")
}

model School {
  id       Int              @id @default(autoincrement())
  teachers Teacher[]
  students Student[]
  subjects SchoolSubjects[]

  @@map("school")
}

model SchoolSubjects {
  id          Int     @id @default(autoincrement())
  title       String
  description String
  school      School  @relation(fields: [schoolId], references: [id])
  schoolId    Int     @map("school_id")
  teacher     Teacher @relation(fields: [teacherId], references: [id])
  teacherId   Int     @map("teacher_id")

  @@map("school_subjects")
}

model Teacher {
  id        Int              @id @default(autoincrement())
  user      User             @relation(fields: [userId], references: [id])
  userId    Int              @unique @map("user_id")
  school    School           @relation(fields: [schoolId], references: [id])
  schoolId  Int              @map("school_id")
  subjects  SchoolSubjects[]
  classroom Classroom?

  @@map("teacher")
}

model Student {
  id          Int       @id @default(autoincrement())
  user        User      @relation(fields: [userId], references: [id])
  userId      Int       @unique @map("user_id")
  school      School    @relation(fields: [schoolId], references: [id])
  schoolId    Int       @map("school_id")
  classroom   Classroom @relation(fields: [classroomId], references: [id])
  classroomId Int       @map("classroom_id")

  @@map("student")
}

model Classroom {
  id        Int       @id @default(autoincrement())
  teacher   Teacher   @relation(fields: [teacherId], references: [id])
  teacherId Int       @unique @map("teacher_id")
  students  Student[]

  @@map("classroom")
}

model Grade {
  id Int @id @default(autoincrement())

  @@map("grade")
}

enum Role {
  ADMIN
  TEACHER
  STUDENT
}
